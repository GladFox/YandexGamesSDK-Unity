(()=>{"use strict";var e={},n=function(){function e(){}return e.isLocalhost=function(){return!1},e}(),t=function(){function e(){}return e.authenticateUser=function(){return e=this,t=void 0,r=function(){var e,t,a,r;return function(e,n){var t,a,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(t=1,a&&(r=2&s[0]?a.return:s[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,s[1])).done)return r;switch(a=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=n.call(e,o)}catch(e){s=[6,e],a=0}finally{t=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(o){switch(o.label){case 0:if(n.isLocalhost())return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,window.yandexSDK.getPlayer()];case 2:return e=o.sent(),t=""!==e.getUniqueID(),r={id:e.getUniqueID(),name:e.getName(),avatarUrlSmall:e.getPhoto("small"),avatarUrlMedium:e.getPhoto("medium"),avatarUrlLarge:e.getPhoto("large"),isAuthorized:t},unityInstance.SendMessage("YandexGamesSDK","OnAuthenticationSuccess",JSON.stringify(r)),[3,4];case 3:return a=o.sent(),unityInstance.SendMessage("YandexGamesSDK","OnAuthenticationFailure",a.message),[3,4];case 4:return[3,6];case 5:r={id:"10223",name:"Turan",isAuthorized:!0},unityInstance.SendMessage("YandexGamesSDK","OnAuthenticationSuccess",JSON.stringify(r)),o.label=6;case 6:return[2]}}))},new((a=void 0)||(a=Promise))((function(n,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}));var e,t,a,r},e}(),a=function(e,n,t,a){return new(t||(t=Promise))((function(r,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}c((a=a.apply(e,n||[])).next())}))},r=function(e,n){var t,a,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(t=1,a&&(r=2&s[0]?a.return:s[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,s[1])).done)return r;switch(a=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=n.call(e,o)}catch(e){s=[6,e],a=0}finally{t=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},o=function(){function e(){}return e.initialize=function(){return a(this,void 0,void 0,(function(){var t;return r(this,(function(a){switch(a.label){case 0:return a.trys.push([0,6,,9]),n.isLocalhost()?[4,e.initializeUnity()]:[3,3];case 1:return a.sent(),[4,e.waitForYandexGamesSDKReady()];case 2:return a.sent(),e.isInitialized=!0,window.unityInstance.SendMessage("YandexGamesSDK","OnSDKInitialized","true"),console.log("Unity initialized successfully on localhost."),[3,5];case 3:return[4,e.loadYandexSDK()];case 4:a.sent(),a.label=5;case 5:return[3,9];case 6:return t=a.sent(),console.error("Failed to initialize:",t.message),[4,e.waitForUnityInstance()];case 7:return a.sent(),[4,e.waitForYandexGamesSDKReady()];case 8:return a.sent(),window.unityInstance.SendMessage("YandexGamesSDK","OnSDKInitialized","false|".concat(t.message)),[3,9];case 9:return[2]}}))}))},e.loadYandexSDK=function(){return a(this,void 0,void 0,(function(){return r(this,(function(n){return[2,new Promise((function(n,t){var a=document.createElement("script");a.src="/sdk.js",a.onload=function(){return e.onYandexSDKLoaded().then(n).catch(t)},a.onerror=function(){console.error("Failed to load Yandex SDK script"),e.initializeUnity().then(n).catch(t)},document.head.appendChild(a)}))]}))}))},e.onYandexSDKLoaded=function(){return a(this,void 0,void 0,(function(){var n,t;return r(this,(function(a){switch(a.label){case 0:return a.trys.push([0,5,,9]),[4,window.YaGames.init()];case 1:return n=a.sent(),window.yandexSDK=n,console.log("Yandex SDK loaded and initialized successfully"),[4,e.initializeUnity()];case 2:return a.sent(),[4,e.waitForUnityInstance()];case 3:case 6:return a.sent(),[4,e.waitForYandexGamesSDKReady()];case 4:return a.sent(),e.sendUnityMessage("OnYSDKLoaded","YSDK loaded successfully"),e.isInitialized=!0,window.unityInstance.SendMessage("YandexGamesSDK","OnSDKInitialized","true"),[3,9];case 5:return t=a.sent(),console.error("Yandex SDK failed to initialize:",t.message),[4,e.waitForUnityInstance()];case 7:return a.sent(),e.sendUnityMessage("OnYSDKLoadFailed",t.message),[4,e.initializeUnity()];case 8:return a.sent(),window.unityInstance.SendMessage("YandexGamesSDK","OnSDKInitialized","false|".concat(t.message)),[3,9];case 9:return[2]}}))}))},e.initializeUnity=function(){return a(this,void 0,void 0,(function(){var n,t,a,o;return r(this,(function(r){return t="".concat(n="Build","/{{{ LOADER_FILENAME }}}"),a={dataUrl:"".concat(n,"/{{{ DATA_FILENAME }}}"),frameworkUrl:"".concat(n,"/{{{ FRAMEWORK_FILENAME }}}"),codeUrl:"".concat(n,"/{{{ CODE_FILENAME }}}"),streamingAssetsUrl:"StreamingAssets",companyName:"{{{ COMPANY_NAME }}}",productName:"{{{ PRODUCT_NAME }}}",productVersion:"{{{ PRODUCT_VERSION }}}"},o=document.querySelector("#unity-canvas"),[2,new Promise((function(n,r){e.loadScript(t,(function(){window.createUnityInstance(o,a,e.updateLoadingProgress).then((function(t){console.log("Unity WebGL instance created successfully"),window.unityInstance=t,window.unityInstance=t,e.unityInitResolve&&(e.unityInitResolve(),e.unityInitResolve=null),n()})).catch((function(e){console.error("Failed to load Unity game:",e),alert("Failed to load Unity game: "+e),r(e)}))}))}))]}))}))},e.loadScript=function(e,n){var t=document.createElement("script");t.src=e,t.onload=n,t.onerror=function(){console.error("Failed to load script:",e),alert("Failed to load Unity loader script.")},document.body.appendChild(t)},e.updateLoadingProgress=function(e){},e.sendUnityMessage=function(e,n){unityInstance?unityInstance.SendMessage("YandexGamesSDK",e,n):console.warn("Unity instance is not initialized.")},e.waitForUnityInstance=function(){return window.unityInstance?Promise.resolve():e.unityInstancePromise},e.waitForYandexGamesSDKReady=function(){return e.yandexGamesSDKReadyPromise},e.OnYandexGamesSDKReady=function(){e.yandexGamesSDKReadyResolve&&(e.yandexGamesSDKReadyResolve(),e.yandexGamesSDKReadyResolve=null)},e.checkForInitialization=function(){return e.isInitialized},e.isInitialized=!1,e.unityInitResolve=null,e.yandexGamesSDKReadyResolve=null,e.unityInstancePromise=new Promise((function(n){e.unityInitResolve=n})),e.yandexGamesSDKReadyPromise=new Promise((function(n){e.yandexGamesSDKReadyResolve=n})),e}(),i=function(e,n,t,a){return new(t||(t=Promise))((function(r,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}c((a=a.apply(e,n||[])).next())}))},s=function(e,n){var t,a,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(t=1,a&&(r=2&s[0]?a.return:s[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,s[1])).done)return r;switch(a=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=n.call(e,o)}catch(e){s=[6,e],a=0}finally{t=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},c=function(){function e(){}return e.savePlayerData=function(e,t){return i(this,arguments,void 0,(function(e,t,a){var r,o;return void 0===a&&(a=!0),s(this,(function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),n.isLocalhost()?[3,3]:[4,window.yandexSDK.getPlayer()];case 1:return[4,i.sent().setData((o={},o[e]=t,o),a)];case 2:return i.sent(),unityInstance.SendMessage("YandexGamesSDK","OnPlayerDataSaved","true"),[3,4];case 3:localStorage.setItem(e,t),console.log("Saved player data locally for key: ".concat(e)),unityInstance.SendMessage("YandexGamesSDK","OnPlayerDataSaved","true"),i.label=4;case 4:return[3,6];case 5:return r=i.sent(),console.error("Failed to save player data:",r.message),unityInstance.SendMessage("YandexGamesSDK","OnPlayerDataSaved","false|".concat(r.message)),[3,6];case 6:return[2]}}))}))},e.loadPlayerData=function(e){return i(this,void 0,void 0,(function(){var t,a,r;return s(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),n.isLocalhost()?[3,3]:[4,window.yandexSDK.getPlayer()];case 1:return[4,o.sent().getData([e])];case 2:return(t=o.sent())&&t.hasOwnProperty(e)?(a=t[e],console.log("Loaded player data from Yandex for key: ".concat(e),a),unityInstance.SendMessage("YandexGamesSDK","OnPlayerDataLoaded",JSON.stringify({success:!0,data:a}))):(console.warn("No data found in Yandex for key: ".concat(e)),unityInstance.SendMessage("YandexGamesSDK","OnPlayerDataLoaded","false|No data found for the given key")),[3,4];case 3:null!==(a=localStorage.getItem(e))?(console.log("Loaded player data locally for key: ".concat(e),a),unityInstance.SendMessage("YandexGamesSDK","OnPlayerDataLoaded",JSON.stringify({success:!0,data:a}))):(console.warn("No data found locally for key: ".concat(e)),unityInstance.SendMessage("YandexGamesSDK","OnPlayerDataLoaded","false|No data found for the given key")),o.label=4;case 4:return[3,6];case 5:return r=o.sent(),console.error("Failed to load player data:",r.message),unityInstance.SendMessage("YandexGamesSDK","OnPlayerDataLoaded","false|".concat(r.message)),[3,6];case 6:return[2]}}))}))},e}(),u=function(e,n,t,a){return new(t||(t=Promise))((function(r,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}c((a=a.apply(e,n||[])).next())}))},l=function(e,n){var t,a,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(t=1,a&&(r=2&s[0]?a.return:s[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,s[1])).done)return r;switch(a=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=n.call(e,o)}catch(e){s=[6,e],a=0}finally{t=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},d=function(){function e(){}return e.submitScore=function(e,t){return u(this,void 0,void 0,(function(){var a,r=this;return l(this,(function(o){switch(o.label){case 0:if(n.isLocalhost())return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,window.yandexSDK.getLeaderboards().then((function(n){return u(r,void 0,void 0,(function(){return l(this,(function(a){switch(a.label){case 0:return[4,n.setLeaderboardScore(e,t)];case 1:return a.sent(),unityInstance.SendMessage("YandexGamesSDK","OnSubmitScoreSuccess",""),[2]}}))}))}))];case 2:return o.sent(),[3,4];case 3:return a=o.sent(),unityInstance.SendMessage("YandexGamesSDK","OnSubmitScoreFailure",a.message),[3,4];case 4:return[3,6];case 5:console.warn("Using mock data for submitScore"),unityInstance.SendMessage("YandexGamesSDK","OnSubmitScoreSuccess",""),o.label=6;case 6:return[2]}}))}))},e.getLeaderboardEntries=function(e,t,a){return u(this,void 0,void 0,(function(){var r,o,i,s=this;return l(this,(function(c){switch(c.label){case 0:if(n.isLocalhost())return[3,5];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,window.yandexSDK.getLeaderboards().then((function(n){return u(s,void 0,void 0,(function(){var r,o,i;return l(this,(function(s){switch(s.label){case 0:return[4,n.getLeaderboardEntries(e,{includeUser:!0,quantityTop:t+a,quantityAround:0})];case 1:return r=s.sent(),o=r.entries.slice(t,t+a),i=JSON.stringify({entries:o}),unityInstance.SendMessage("YandexGamesSDK","OnGetLeaderboardEntriesSuccess",i),[2]}}))}))}))];case 2:return c.sent(),[3,4];case 3:return r=c.sent(),unityInstance.SendMessage("YandexGamesSDK","OnGetLeaderboardEntriesFailure",r.message),[3,4];case 4:return[3,6];case 5:console.warn("Using mock data for getLeaderboardEntries"),o=[{score:1e3,rank:1,player:{publicName:"Player1",uniqueID:"1",getAvatarSrc:function(e){return""},getAvatarSrcSet:function(e){return""},lang:"en",scopePermissions:{avatar:"granted",public_name:"granted"}},formattedScore:"1,000"},{score:900,rank:2,player:{publicName:"Player2",uniqueID:"2",getAvatarSrc:function(e){return""},getAvatarSrcSet:function(e){return""},lang:"en",scopePermissions:{avatar:"granted",public_name:"granted"}},formattedScore:"900"}],i=JSON.stringify({entries:o}),unityInstance.SendMessage("YandexGamesSDK","OnGetLeaderboardEntriesSuccess",i),c.label=6;case 6:return[2]}}))}))},e.getPlayerEntry=function(e){return u(this,void 0,void 0,(function(){var t,a,r,o=this;return l(this,(function(i){switch(i.label){case 0:if(n.isLocalhost())return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,window.yandexSDK.getLeaderboards().then((function(n){return u(o,void 0,void 0,(function(){var t,a;return l(this,(function(r){switch(r.label){case 0:return[4,n.getLeaderboardPlayerEntry(e)];case 1:return t=r.sent(),a=JSON.stringify(t),unityInstance.SendMessage("YandexGamesSDK","OnGetPlayerEntrySuccess",a),[2]}}))}))}))];case 2:return i.sent(),[3,4];case 3:return t=i.sent(),unityInstance.SendMessage("YandexGamesSDK","OnGetPlayerEntryFailure",t.message),[3,4];case 4:return[3,6];case 5:console.warn("Using mock data for getPlayerEntry"),a={score:800,rank:3,player:{publicName:"MockPlayer",uniqueID:"mock_user",getAvatarSrc:function(e){return""},getAvatarSrcSet:function(e){return""},lang:"en",scopePermissions:{avatar:"granted",public_name:"granted"}},formattedScore:"800"},r=JSON.stringify(a),unityInstance.SendMessage("YandexGamesSDK","OnGetPlayerEntrySuccess",r),i.label=6;case 6:return[2]}}))}))},e}();window.YandexSDKVersion="1.0.0",window.YandexSDKExports={AuthenticateUser:t.authenticateUser,SavePlayerData:c.savePlayerData,LoadPlayerData:c.loadPlayerData,CheckForInitialization:o.checkForInitialization,OnYandexGamesSDKReady:o.OnYandexGamesSDKReady,SubmitScore:d.submitScore,GetLeaderboardEntries:d.getLeaderboardEntries,GetPlayerEntry:d.getPlayerEntry},window.addEventListener("load",(function(){o.initialize()}));var f=window;for(var y in e)f[y]=e[y];e.__esModule&&Object.defineProperty(f,"__esModule",{value:!0})})();